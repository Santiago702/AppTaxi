@model ModeloVista
@{
    ViewData["Title"] = "Agregar Usuario";
    Layout = "~/Views/Shared/_LayoutSecretaria.cshtml";
}
@if (TempData["Mensaje"] != null)
{
    <div class="alert alert-warning text-center">@TempData["Mensaje"]</div>
}

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0 text-center"><strong>Agregar Nuevo Usuario</strong></h4>
                </div>
                <div class="card-body">
                    <form asp-action="Crear_Usuario" asp-controller="Secretaria" method="post" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label class="form-label"><strong>Foto:</strong></label>
                            <input type="file" class="form-control" asp-for="Archivo_4" placeholder="Foto" accept=".png, .jpg, .jpeg">
                        </div>
                        <div class="mb-3">
                            <label class="form-label"><strong>Nombre:</strong></label>
                            <input type="text" class="form-control" placeholder="Digite el nombre" asp-for="Usuario.Nombre" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label"><strong>Correo:</strong></label>
                            <input type="email" class="form-control" placeholder="Digite el correo" asp-for="Usuario.Correo" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label"><strong>Contraseña:</strong></label>
                            <input type="password" class="form-control" id="password" asp-for="Usuario.Contrasena" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label"><strong>Confirmar Contraseña:</strong></label>
                            <input type="password" class="form-control" id="confirmPassword"  required>
                            <small id="passwordError" class="text-danger d-none">Las contraseñas no coinciden</small>
                        </div>
                        <div class="mb-3">
                            <label class="form-label"><strong>Celular 1:</strong></label>
                            <input type="number" class="form-control" placeholder="Digite Celular" asp-for="Usuario.Celular" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label"><strong>Celular 2:</strong></label>
                            <input type="number" class="form-control" placeholder="Digite Celular Alternativo" asp-for="Usuario.Telefono">
                        </div>
                        <div class="mb-3">
                            <label class="form-label"><strong>Dirección:</strong></label>
                            <input type="text" class="form-control" placeholder="Cra X #xx - yy" asp-for="Usuario.Direccion" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label"><strong>Ciudad:</strong></label>
                            <input type="text" class="form-control" placeholder="Ciudad o Municipio" asp-for="Usuario.Ciudad" required>
                        </div>
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary">Agregar Usuario</button>
                            <a href="javascript:history.back()" class="btn btn-outline-secondary">Volver</a>
                        </div>
                    </form>
                    @if (!string.IsNullOrEmpty(ViewBag.Mensaje))
                    {
                        <div class="alert alert-info mt-3" role="alert">
                            @ViewBag.Mensaje
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const password = document.getElementById("password");
        const confirmPassword = document.getElementById("confirmPassword");
        const passwordError = document.getElementById("passwordError");
        const submitButton = document.querySelector("button[type='submit']");

        function validatePassword() {
            if (confirmPassword.value !== password.value || confirmPassword.value === "") {
                passwordError.classList.remove("d-none");
                submitButton.disabled = true; // Deshabilita el botón
            } else {
                passwordError.classList.add("d-none");
                submitButton.disabled = false; // Habilita el botón
            }
        }

        password.addEventListener("input", validatePassword);
        confirmPassword.addEventListener("input", validatePassword);

        // Evitar el envío del formulario si las contraseñas no coinciden
        document.querySelector("form").addEventListener("submit", function (event) {
            if (confirmPassword.value !== password.value) {
                event.preventDefault(); // Bloquea el envío del formulario
            }
        });
    });
</script>

