@model ModeloVista
@{
    ViewData["Title"] = "Papelera";
    Layout = "~/Views/Shared/_LayoutEmpresa.cshtml";
}
<p class="text-sm-center"><strong>Cupos Disponibles : </strong>@ViewBag.Cupos</p>
<br />
<h1 class="text-center text-secondary mb-4">Papelera de Reciclaje</h1>

<div class="container">
    <!-- Conductores -->
    <h3 class="mb-4 text-center text-primary">Conductores de la Empresa</h3>
    <div class="d-flex justify-content-between align-items-center mb-3">
        
        <input type="text" id="buscarConductor" class="form-control w-25" placeholder="🔍 Buscar por nombre..." onkeyup="filtrarTabla('buscarConductor', 'tablaConductores')">
    </div>

    @if (Model != null && Model.Conductores.Any())
    {
        <div class="table-responsive">
            <table class="table table-hover table-striped text-center" id="tablaConductores">
                <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Estado</th>
                        <th>Nombre</th>
                        
                        <th>Cédula</th>
                        <th>Teléfono</th>
                        <th>Correo</th>
                        <th>Ciudad</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Conductores)
                    {
                        <tr data-search="@item.Nombre">
                            <td>@item.IdConductor</td>
                            <td><span class="badge @(item.Estado ? "bg-success" : "bg-danger")">@(item.Estado ? "Activo" : "Inactivo")</span></td>
                            <td>@item.Nombre</td>
                            
                            <td>@item.NumeroCedula</td>
                            <td>@item.Telefono</td>
                            <td>@item.Correo</td>
                            <td>@item.Ciudad</td>
                            <td>
                                <a asp-action="Detalle_Conductor" asp-route-IdConductor="@item.IdConductor" class="btn btn-primary btn-sm">Detalle</a>
                                <form asp-action="Recuperar_Conductor" method="post" style="display:inline;">
                                    <input type="hidden" name="IdConductor" value="@item.IdConductor">
                                    <button type="submit" class="btn btn-outline-success btn-sm">Recuperar</button>
                                </form>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
    else
    {
        <div class="alert alert-warning text-center mt-4">
            <strong>⚠ No se encontraron conductores eliminados.</strong>
        </div>
    }

    <hr class="my-5">

    <!-- Vehículos -->
    <h3 class="mb-4 text-center text-primary">Vehículos de la Empresa</h3>
    <div class="d-flex justify-content-between align-items-center mb-3">
       
        <input type="text" id="buscarVehiculo" class="form-control w-25" placeholder="🔍 Buscar por placa..." onkeyup="filtrarTabla('buscarVehiculo', 'tablaVehiculos')">
    </div>

    @if (Model != null && Model.Vehiculos.Any())
    {
        <div class="table-responsive">
            <table class="table table-hover table-striped text-center" id="tablaVehiculos">
                <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Estado</th>
                        <th>Placa</th>
                        <th>SOAT</th>
                        <th>Técnico Mecánica</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Vehiculos)
                    {
                        <tr data-search="@item.Placa">
                            <td>@item.IdVehiculo</td>
                            <td><span class="badge @(item.Estado ? "bg-success" : "bg-danger")">@(item.Estado ? "Habilitado" : "No Habilitado")</span></td>
                            <td>@item.Placa</td>
                            <td><span class="badge @(item.Soat != null ? "bg-success" : "bg-danger")">@(item.Soat != null ? "Sí" : "No")</span></td>
                            <td><span class="badge @(item.TecnicoMecanica != null ? "bg-success" : "bg-danger")">@(item.TecnicoMecanica != null ? "Sí" : "No")</span></td>
                            <td>
                                <a asp-action="Detalle_Vehiculo" asp-route-IdVehiculo="@item.IdVehiculo" class="btn btn-primary btn-sm">Detalle</a>
                                <form asp-action="Recuperar_Vehiculo" method="post" style="display:inline;">
                                    <input type="hidden" name="IdVehiculo" value="@item.IdVehiculo">
                                    <button type="submit" class="btn btn-outline-success btn-sm">Recuperar</button>
                                </form>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
    else
    {
        <div class="alert alert-warning text-center mt-4">
            <strong>⚠ No se encontraron vehículos eliminados.</strong>
        </div>
    }

    <hr class="my-5">

    <!-- Propietarios -->
    <h3 class="mb-4 text-center text-primary">Propietarios de la Empresa</h3>
    <div class="d-flex justify-content-between align-items-center mb-3">
        
        <input type="text" id="buscarPropietario" class="form-control w-25" placeholder="🔍 Buscar por nombre..." onkeyup="filtrarTabla('buscarPropietario', 'tablaPropietarios')">
    </div>

    @if (Model != null && Model.Propietarios.Any())
    {
        <div class="table-responsive">
            <table class="table table-hover table-striped text-center" id="tablaPropietarios">
                <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Estado</th>
                        <th>Nombre</th>
                        <th>Cédula</th>
                        <th>Teléfono</th>
                        <th>Correo</th>
                        <th>Ciudad</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Propietarios)
                    {
                        <tr data-search="@item.Nombre">
                            <td>@item.IdPropietario</td>
                            <td><span class="badge @(item.Estado ? "bg-success" : "bg-danger")">@(item.Estado ? "Activo" : "Inactivo")</span></td>
                            <td>@item.Nombre</td>
                            <td>@item.NumeroCedula</td>
                            <td>@item.Telefono</td>
                            <td>@item.Correo</td>
                            <td>@item.Ciudad</td>
                            <td>
                                <a asp-action="Detalle_Propietario" asp-route-IdPropietario="@item.IdPropietario" class="btn btn-primary btn-sm">Detalle</a>
                                <form asp-action="Recuperar_Propietario" method="post" style="display:inline;">
                                    <input type="hidden" name="IdPropietario" value="@item.IdPropietario">
                                    <button type="submit" class="btn btn-outline-success btn-sm">Recuperar</button>
                                </form>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
    else
    {
        <div class="alert alert-warning text-center mt-4">
            <strong>⚠ No se encontraron propietarios eliminados.</strong>
        </div>
    }
</div>

<script>
    function filtrarTabla(inputId, tableId) {
        let input = document.getElementById(inputId).value.toLowerCase();
        let filas = document.querySelectorAll(`#${tableId} tbody tr`);

        filas.forEach(fila => {
            let contenido = fila.getAttribute("data-search").toLowerCase();
            fila.style.display = contenido.includes(input) ? "" : "none";
        });
    }
</script>
